{"ast":null,"code":"import _classCallCheck from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/vadym/Documents/work/job/wedge/src/views/Security/Security.jsx\";\nimport PropTypes from 'prop-types';\nimport React, { Component } from 'react';\nimport Modal from 'react-modal';\nimport { connect } from 'react-redux';\nimport AddButton from '../../components/AddButton/AddButton';\nimport Loader from '../../components/Loader/Loader';\nimport Table from '../../components/Table/Table';\nimport WedgeModal from '../../components/WedgeModal/WedgeModal';\nimport { POLICY_TABLE_FIELDS } from '../../enums';\nimport { createErrorMessageSelector, createLoadingSelector } from '../../store/utils/selectors';\nimport CreateNewService from '../Modals/CreateNewService';\nimport NewPolicySurvey from '../Modals/NewPolicySurvey';\nimport PolicyTableItem from './components/PolicyTableItem/PolicyTableItem';\nimport SearchBar from './components/SearchBar/SearchBar';\nimport { createPolicy as _createPolicy, fetchPolicies as _fetchPolicies, updatePolicy as _updatePolicy, createService as _createService } from './scenario-actions';\nimport './security.scss';\nModal.setAppElement('#modal-root');\n\nvar Security =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Security, _Component);\n\n  function Security() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, Security);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Security)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      createModalOpened: true,\n      detailModalOpened: false,\n      editModalOpened: false,\n      serviceModalOpened: false,\n      detailsOf: {}\n    };\n\n    _this.onEditClick = function () {\n      _this.openEditModal();\n    };\n\n    _this.openModal = function () {\n      _this.setState({\n        createModalOpened: true\n      });\n    };\n\n    _this.openDetailsModal = function (item) {\n      _this.setState({\n        detailsOf: item,\n        detailModalOpened: true\n      });\n    };\n\n    _this.closeDetailsModal = function () {\n      _this.setState({\n        detailModalOpened: false\n      });\n    };\n\n    _this.openServiceCreateModal = function () {\n      _this.setState({\n        serviceModalOpened: true\n      });\n    };\n\n    _this.closeServiceCreateModal = function () {\n      _this.setState({\n        serviceModalOpened: false\n      });\n    };\n\n    _this.openEditModal = function (item) {\n      _this.setState({\n        detailsOf: item || _this.state.detailsOf,\n        keepDetailsOpened: _this.state.detailModalOpened,\n        detailModalOpened: false,\n        editModalOpened: true\n      });\n    };\n\n    _this.closeEditModal = function () {\n      _this.setState({\n        editModalOpened: false,\n        detailModalOpened: _this.state.keepDetailsOpened,\n        keepDetailsOpened: false\n      });\n    };\n\n    _this.closeCreateModal = function () {\n      _this.setState({\n        createModalOpened: false\n      });\n    };\n\n    _this.renderDetailModal = function () {\n      return null; //<Details data={ this.state.detailsOf }/>\n    };\n\n    _this.renderEditModal = function () {\n      return null; //<Survey onFinish={ this.onEdit } item={ this.state.detailsOf } edit/>\n    };\n\n    _this.renderCreationModal = function () {\n      return React.createElement(NewPolicySurvey, {\n        onFinish: function onFinish(newPolicy) {\n          return _this.onAdd(newPolicy);\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106\n        },\n        __self: this\n      });\n    };\n\n    _this.onAdd = function (entity) {\n      _this.props.createPolicy(entity);\n\n      _this.closeCreateModal();\n    };\n\n    _this.onEdit = function (entity) {\n      _this.props.updatePolicy(entity);\n\n      _this.closeEditModal();\n    };\n\n    _this.onCreateService = function (service) {\n      _this.props.createService(service);\n\n      _this.closeServiceCreateModal();\n    };\n\n    _this.renderPolicies = function (matches) {\n      var items = _this.props.items;\n      return items.map(function (item, index) {\n        return React.createElement(PolicyTableItem, {\n          key: \"policy-table-item-\".concat(item.id, \"-\").concat(item.name),\n          responsive: matches,\n          data: item,\n          index: index + 1,\n          onEdit: function onEdit() {\n            return _this.openEditModal(item);\n          },\n          onDetails: function onDetails() {\n            return _this.openDetailsModal(item);\n          },\n          onNewService: _this.openServiceCreateModal,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127\n          },\n          __self: this\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(Security, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.props.fetchPolicies();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"content policies\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: 'policies__search-bar',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(SearchBar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      })), React.createElement(AddButton, {\n        onClick: this.openModal,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, \"Add New Policy\"), React.createElement(Table.Container, {\n        root: 'policies',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }, React.createElement(Table.Content, {\n        root: 'policies',\n        headerComponent: React.createElement(Table.Header, {\n          items: POLICY_TABLE_FIELDS,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149\n          },\n          __self: this\n        }),\n        renderItems: this.renderPolicies,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      })), this.props.isLoading && React.createElement(\"div\", {\n        className: 'loader-container',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, React.createElement(Loader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      })), React.createElement(WedgeModal, {\n        isOpen: this.state.createModalOpened,\n        onClose: this.closeCreateModal,\n        title: 'Create new policy',\n        size: 'big',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, this.renderCreationModal()), React.createElement(WedgeModal, {\n        isOpen: this.state.detailModalOpened,\n        onClose: this.closeDetailsModal,\n        additionalAction: {\n          icon: 'pe-7s-config',\n          callback: this.onEditClick\n        },\n        title: \"\".concat(this.state.detailsOf.name, \" - Details\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 166\n        },\n        __self: this\n      }, this.renderDetailModal()), React.createElement(WedgeModal, {\n        isOpen: this.state.editModalOpened,\n        onClose: this.closeEditModal,\n        title: \"\".concat(this.state.detailsOf.name, \" - Edit\"),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177\n        },\n        __self: this\n      }, this.renderEditModal()), React.createElement(WedgeModal, {\n        size: 'small',\n        isOpen: this.state.serviceModalOpened,\n        onClose: this.closeServiceCreateModal,\n        title: 'Create new service',\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(CreateNewService, {\n        onFinish: this.onCreateService,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Security;\n}(Component);\n\nSecurity.propTypes = {\n  fetchPolicies: PropTypes.func.isRequired,\n  createPolicy: PropTypes.func.isRequired,\n  updatePolicy: PropTypes.func.isRequired,\n  createService: PropTypes.func.isRequired,\n  items: PropTypes.array.isRequired,\n  isLoading: PropTypes.bool.isRequired\n};\nSecurity.defaultProps = {\n  items: []\n};\nvar loadingSelector = createLoadingSelector(['FETCHING_POLICIES']);\nvar errorSelector = createErrorMessageSelector(['FETCHING_POLICIES']);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    items: policiesSelector(state),\n    isLoading: loadingSelector(state),\n    error: errorSelector(state)\n  };\n};\n\nvar policiesSelector = function policiesSelector(state) {\n  var ecosystem = state.ecosystems.currentEcosystem;\n\n  if (ecosystem) {\n    return state.policies[ecosystem.uuid] ? state.policies[ecosystem.uuid].policies : [];\n  }\n\n  return [];\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    fetchPolicies: function fetchPolicies() {\n      return dispatch(_fetchPolicies());\n    },\n    createPolicy: function createPolicy(entity, type) {\n      return dispatch(_createPolicy(entity, type));\n    },\n    updatePolicy: function updatePolicy(entity) {\n      return dispatch(_updatePolicy(entity));\n    },\n    createService: function createService(service) {\n      return dispatch(_createService(service));\n    }\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Security);","map":{"version":3,"sources":["/Users/vadym/Documents/work/job/wedge/src/views/Security/Security.jsx"],"names":["PropTypes","React","Component","Modal","connect","AddButton","Loader","Table","WedgeModal","POLICY_TABLE_FIELDS","createErrorMessageSelector","createLoadingSelector","CreateNewService","NewPolicySurvey","PolicyTableItem","SearchBar","createPolicy","fetchPolicies","updatePolicy","createService","setAppElement","Security","state","createModalOpened","detailModalOpened","editModalOpened","serviceModalOpened","detailsOf","onEditClick","openEditModal","openModal","setState","openDetailsModal","item","closeDetailsModal","openServiceCreateModal","closeServiceCreateModal","keepDetailsOpened","closeEditModal","closeCreateModal","renderDetailModal","renderEditModal","renderCreationModal","newPolicy","onAdd","entity","props","onEdit","onCreateService","service","renderPolicies","matches","items","map","index","id","name","isLoading","icon","callback","propTypes","func","isRequired","array","bool","defaultProps","loadingSelector","errorSelector","mapStateToProps","policiesSelector","error","ecosystem","ecosystems","currentEcosystem","policies","uuid","mapDispatchToProps","dispatch","type"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types'\nimport React, { Component } from 'react'\nimport Modal from 'react-modal'\nimport { connect } from 'react-redux'\nimport AddButton from '../../components/AddButton/AddButton'\nimport Loader from '../../components/Loader/Loader'\nimport Table from '../../components/Table/Table'\nimport WedgeModal from '../../components/WedgeModal/WedgeModal'\nimport { POLICY_TABLE_FIELDS } from '../../enums'\nimport {\n\tcreateErrorMessageSelector,\n\tcreateLoadingSelector\n} from '../../store/utils/selectors'\nimport CreateNewService from '../Modals/CreateNewService'\nimport NewPolicySurvey from '../Modals/NewPolicySurvey'\nimport PolicyTableItem from './components/PolicyTableItem/PolicyTableItem'\nimport SearchBar from './components/SearchBar/SearchBar'\nimport {\n\tcreatePolicy,\n\tfetchPolicies,\n\tupdatePolicy,\n\tcreateService\n} from './scenario-actions'\nimport './security.scss'\n\nModal.setAppElement('#modal-root')\n\nclass Security extends Component {\n\tstate = {\n\t\tcreateModalOpened: true,\n\t\tdetailModalOpened: false,\n\t\teditModalOpened: false,\n\t\tserviceModalOpened: false,\n\t\tdetailsOf: {}\n\t}\n\n\tonEditClick = () => {\n\t\tthis.openEditModal()\n\t}\n\n\topenModal = () => {\n\t\tthis.setState({ createModalOpened: true })\n\t}\n\n\topenDetailsModal = item => {\n\t\tthis.setState({\n\t\t\tdetailsOf: item,\n\t\t\tdetailModalOpened: true\n\t\t})\n\t}\n\n\tcloseDetailsModal = () => {\n\t\tthis.setState({\n\t\t\tdetailModalOpened: false\n\t\t})\n\t}\n\n\topenServiceCreateModal = () => {\n\t\tthis.setState({\n\t\t\tserviceModalOpened: true\n\t\t})\n\t}\n\n\tcloseServiceCreateModal = () => {\n\t\tthis.setState({\n\t\t\tserviceModalOpened: false\n\t\t})\n\t}\n\n\topenEditModal = item => {\n\t\tthis.setState({\n\t\t\tdetailsOf: item || this.state.detailsOf,\n\t\t\tkeepDetailsOpened: this.state.detailModalOpened,\n\t\t\tdetailModalOpened: false,\n\t\t\teditModalOpened: true\n\t\t})\n\t}\n\n\tcloseEditModal = () => {\n\t\tthis.setState({\n\t\t\teditModalOpened: false,\n\t\t\tdetailModalOpened: this.state.keepDetailsOpened,\n\t\t\tkeepDetailsOpened: false\n\t\t})\n\t}\n\n\tcloseCreateModal = () => {\n\t\tthis.setState({\n\t\t\tcreateModalOpened: false\n\t\t})\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.fetchPolicies()\n\t}\n\n\trenderDetailModal = () => {\n\t\treturn null //<Details data={ this.state.detailsOf }/>\n\t}\n\n\trenderEditModal = () => {\n\t\treturn null //<Survey onFinish={ this.onEdit } item={ this.state.detailsOf } edit/>\n\t}\n\n\trenderCreationModal = () => {\n\t\treturn <NewPolicySurvey onFinish={newPolicy => this.onAdd(newPolicy)} />\n\t}\n\n\tonAdd = entity => {\n\t\tthis.props.createPolicy(entity)\n\t\tthis.closeCreateModal()\n\t}\n\n\tonEdit = entity => {\n\t\tthis.props.updatePolicy(entity)\n\t\tthis.closeEditModal()\n\t}\n\n\tonCreateService = service => {\n\t\tthis.props.createService(service)\n\t\tthis.closeServiceCreateModal()\n\t}\n\n\trenderPolicies = matches => {\n\t\tconst { items } = this.props\n\t\treturn items.map((item, index) => (\n\t\t\t<PolicyTableItem\n\t\t\t\tkey={`policy-table-item-${item.id}-${item.name}`}\n\t\t\t\tresponsive={matches}\n\t\t\t\tdata={item}\n\t\t\t\tindex={index + 1}\n\t\t\t\tonEdit={() => this.openEditModal(item)}\n\t\t\t\tonDetails={() => this.openDetailsModal(item)}\n\t\t\t\tonNewService={this.openServiceCreateModal}\n\t\t\t/>\n\t\t))\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"content policies\">\n\t\t\t\t<div className={'policies__search-bar'}>\n\t\t\t\t\t<SearchBar />\n\t\t\t\t</div>\n\t\t\t\t<AddButton onClick={this.openModal}>Add New Policy</AddButton>\n\t\t\t\t<Table.Container root={'policies'}>\n\t\t\t\t\t<Table.Content\n\t\t\t\t\t\troot={'policies'}\n\t\t\t\t\t\theaderComponent={<Table.Header items={POLICY_TABLE_FIELDS} />}\n\t\t\t\t\t\trenderItems={this.renderPolicies}\n\t\t\t\t\t/>\n\t\t\t\t</Table.Container>\n\t\t\t\t{this.props.isLoading && (\n\t\t\t\t\t<div className={'loader-container'}>\n\t\t\t\t\t\t<Loader />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t<WedgeModal\n\t\t\t\t\tisOpen={this.state.createModalOpened}\n\t\t\t\t\tonClose={this.closeCreateModal}\n\t\t\t\t\ttitle={'Create new policy'}\n\t\t\t\t\tsize={'big'}\n\t\t\t\t>\n\t\t\t\t\t{this.renderCreationModal()}\n\t\t\t\t</WedgeModal>\n\t\t\t\t<WedgeModal\n\t\t\t\t\tisOpen={this.state.detailModalOpened}\n\t\t\t\t\tonClose={this.closeDetailsModal}\n\t\t\t\t\tadditionalAction={{\n\t\t\t\t\t\ticon: 'pe-7s-config',\n\t\t\t\t\t\tcallback: this.onEditClick\n\t\t\t\t\t}}\n\t\t\t\t\ttitle={`${this.state.detailsOf.name} - Details`}\n\t\t\t\t>\n\t\t\t\t\t{this.renderDetailModal()}\n\t\t\t\t</WedgeModal>\n\t\t\t\t<WedgeModal\n\t\t\t\t\tisOpen={this.state.editModalOpened}\n\t\t\t\t\tonClose={this.closeEditModal}\n\t\t\t\t\ttitle={`${this.state.detailsOf.name} - Edit`}\n\t\t\t\t>\n\t\t\t\t\t{this.renderEditModal()}\n\t\t\t\t</WedgeModal>\n\t\t\t\t<WedgeModal\n\t\t\t\t\tsize={'small'}\n\t\t\t\t\tisOpen={this.state.serviceModalOpened}\n\t\t\t\t\tonClose={this.closeServiceCreateModal}\n\t\t\t\t\ttitle={'Create new service'}\n\t\t\t\t>\n\t\t\t\t\t<CreateNewService onFinish={this.onCreateService} />\n\t\t\t\t</WedgeModal>\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nSecurity.propTypes = {\n\tfetchPolicies: PropTypes.func.isRequired,\n\tcreatePolicy: PropTypes.func.isRequired,\n\tupdatePolicy: PropTypes.func.isRequired,\n\tcreateService: PropTypes.func.isRequired,\n\titems: PropTypes.array.isRequired,\n\tisLoading: PropTypes.bool.isRequired\n}\n\nSecurity.defaultProps = {\n\titems: []\n}\n\nconst loadingSelector = createLoadingSelector(['FETCHING_POLICIES'])\nconst errorSelector = createErrorMessageSelector(['FETCHING_POLICIES'])\n\nconst mapStateToProps = state => {\n\treturn {\n\t\titems: policiesSelector(state),\n\t\tisLoading: loadingSelector(state),\n\t\terror: errorSelector(state)\n\t}\n}\n\nconst policiesSelector = state => {\n\tconst ecosystem = state.ecosystems.currentEcosystem\n\tif (ecosystem) {\n\t\treturn state.policies[ecosystem.uuid]\n\t\t\t? state.policies[ecosystem.uuid].policies\n\t\t\t: []\n\t}\n\n\treturn []\n}\n\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\tfetchPolicies: () => dispatch(fetchPolicies()),\n\t\tcreatePolicy: (entity, type) => dispatch(createPolicy(entity, type)),\n\t\tupdatePolicy: entity => dispatch(updatePolicy(entity)),\n\t\tcreateService: service => dispatch(createService(service))\n\t}\n}\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(Security)\n"]},"metadata":{},"sourceType":"module"}