{"ast":null,"code":"import _regeneratorRuntime from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/regenerator\";\nimport _objectSpread from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _asyncToGenerator from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"/Users/vadym/Documents/work/job/wedge/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport axios from 'axios';\nimport MockAdapter from 'axios-mock-adapter';\nimport humps from 'humps';\nimport { LOCAL_ACCESS_TOKEN_KEY } from '../enums';\nimport store from '../store';\nimport { logoutUser, renewToken } from '../store/auth/actions';\nimport { list, newOne } from './mocks/fetch_objects';\nimport { newService, policiesList } from './mocks/fetch_policies';\nexport var auth = axios.create({\n  baseURL: process.env.REACT_APP_API_URL\n});\nexport var rest = axios.create({\n  baseURL: process.env.REACT_APP_API_URL,\n  transformResponse: [].concat(_toConsumableArray(axios.defaults.transformResponse), [function (data) {\n    return humps.camelizeKeys(data);\n  }])\n});\nrest.interceptors.request.use(function (config) {\n  var token = localStorage.getItem(LOCAL_ACCESS_TOKEN_KEY);\n\n  if (token === null) {\n    store.dispatch(logoutUser());\n    return config;\n  }\n\n  config.headers.Authorization = \"Bearer \".concat(token);\n  return config;\n}, function (err) {\n  return Promise.reject(err);\n});\nrest.interceptors.response.use(function (response) {\n  store.dispatch(renewToken());\n  return response;\n}, function (error) {\n  if (error.status === 401) {\n    localStorage.removeItem(LOCAL_ACCESS_TOKEN_KEY);\n    store.dispatch(logoutUser());\n  }\n\n  return Promise.reject(error);\n});\n\nif (process.env.REACT_APP_ENABLE_MOCK === 'true') {\n  var readUserMockReponse = require('./mocks/read_user');\n\n  var createUserMockReponse = require('./mocks/create_user');\n\n  var fulfillUserMockResponse = require('./mocks/fulfill_user');\n\n  var restMock = new MockAdapter(rest, {\n    delayResponse: 300\n  });\n  restMock.onGet('/ecosystems/00790f55-a0a5-f4a4-6041-f291324f89a1/objects').reply(200, list).onGet('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/policies').reply(200, policiesList).onPost('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/policies').reply(200, {}).onPost('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/services').reply(201, newService).onPost('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/objects').reply(201, newOne).onPut('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/objects/2ewsvw234ewrdsf').reply(400).onGet(new RegExp('/v2/users/*')).reply(readUserMockReponse).onPut(new RegExp('/v2/users/*')).reply(fulfillUserMockResponse).onAny().passThrough();\n  var authMock = new MockAdapter(auth, {\n    delayResponse: 300\n  });\n  authMock.onPost(\"v2/users\").reply(createUserMockReponse);\n}\n\nexport function fetchEcosystems(_ref) {\n  var customer = _ref.customer;\n  return rest.get(\"/v2/customers/\".concat(customer, \"/ecosystems\")).then(function (response) {\n    return response.data;\n  });\n}\nexport function createEcosystem(_ref2) {\n  var customer = _ref2.customer,\n      entity = _ref2.entity;\n  return rest.post(\"/v2/customers/\".concat(customer, \"/ecosystems\"), {\n    name: entity.name,\n    nsps: ['EWR1']\n  }).then(function (response) {\n    return response.data;\n  });\n}\nexport function fetchObjects(_ref3) {\n  var ecosystem = _ref3.ecosystem;\n  return rest.get(\"/ecosystems/\".concat(ecosystem.uuid, \"/objects\")).then(function (response) {\n    return response.data;\n  });\n}\nexport function fetchPolicies(_ref4) {\n  var ecosystem = _ref4.ecosystem;\n  return rest.get(\"/ecosystems/\".concat(ecosystem.uuid, \"/policies\")).then(function (response) {\n    return response.data;\n  });\n}\nexport function createObject(object, type) {\n  return rest.post(getUrlForType(type), object).then(function (response) {\n    return response.data;\n  });\n}\nexport function updateObject(object) {\n  return rest.put(\"\".concat(getUrlForType(object.element), \"/\").concat(object.id), object);\n}\nexport function createService(service, ecosystem) {\n  return rest.post(\"/ecosystems/\".concat(ecosystem.uuid, \"/services\"), service).then(function (response) {\n    return response.data;\n  });\n}\nexport function createPolicy(policy, ecosystem) {\n  return rest.post(\"/ecosystems/\".concat(ecosystem.uuid, \"/policies\"), policy).then(function (response) {\n    return response.data;\n  });\n}\nexport function login(credentials) {\n  return auth.post(\"v2/auth/login\", credentials).then(function (response) {\n    return response.data;\n  });\n}\nexport function logout() {\n  return rest.post(\"/v2/auth/logout\", {}).then(function (response) {\n    return response.data;\n  });\n}\nexport function fetchReports(_x) {\n  return _fetchReports.apply(this, arguments);\n} // TODO: it's mocked\n\nfunction _fetchReports() {\n  _fetchReports = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee(_ref5) {\n    var query, ecosystem, customer, hits;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            query = _ref5.query, ecosystem = _ref5.ecosystem, customer = _ref5.customer;\n            _context.next = 3;\n            return rest.post(\"/v2/customers/\".concat(customer, \"/ecosystems/\").concat(ecosystem, \"/logs/_search\"), query).then(function (response) {\n              return response.data.hits.hits;\n            });\n\n          case 3:\n            hits = _context.sent;\n            return _context.abrupt(\"return\", hits.map(function (report) {\n              return _objectSpread({}, report.source, {\n                id: report.id\n              });\n            }).map(function (report) {\n              return {\n                id: report.id,\n                date: report.eventDatetime,\n                policy: report.policyID,\n                source: report.sourceGeography,\n                service: {\n                  protocol: '',\n                  port: report.destinationPort,\n                  tcp: 'UDP',\n                  status: ''\n                },\n                application: '',\n                destination: report.destinationGeography,\n                actions: [report.eventAction],\n                alert: 'Threat',\n                status: 'active'\n              };\n            }));\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, this);\n  }));\n  return _fetchReports.apply(this, arguments);\n}\n\nfunction getUrlForType(type) {\n  var ecosystem = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'e6960bd4-2275-4d55-a1e7-a9101e79ba36';\n  return \"/ecosystems/\".concat(ecosystem, \"/objects\");\n}","map":{"version":3,"sources":["/Users/vadym/Documents/work/job/wedge/src/api/rest.js"],"names":["axios","MockAdapter","humps","LOCAL_ACCESS_TOKEN_KEY","store","logoutUser","renewToken","list","newOne","newService","policiesList","auth","create","baseURL","process","env","REACT_APP_API_URL","rest","transformResponse","defaults","data","camelizeKeys","interceptors","request","use","config","token","localStorage","getItem","dispatch","headers","Authorization","err","Promise","reject","response","error","status","removeItem","REACT_APP_ENABLE_MOCK","readUserMockReponse","require","createUserMockReponse","fulfillUserMockResponse","restMock","delayResponse","onGet","reply","onPost","onPut","RegExp","onAny","passThrough","authMock","fetchEcosystems","customer","get","then","createEcosystem","entity","post","name","nsps","fetchObjects","ecosystem","uuid","fetchPolicies","createObject","object","type","getUrlForType","updateObject","put","element","id","createService","service","createPolicy","policy","login","credentials","logout","fetchReports","query","hits","map","report","source","date","eventDatetime","policyID","sourceGeography","protocol","port","destinationPort","tcp","application","destination","destinationGeography","actions","eventAction","alert"],"mappings":"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","sourcesContent":["import axios from 'axios'\nimport MockAdapter from 'axios-mock-adapter'\nimport humps from 'humps'\n\nimport { LOCAL_ACCESS_TOKEN_KEY } from '../enums'\nimport store from '../store'\nimport { logoutUser, renewToken } from '../store/auth/actions'\nimport { list, newOne } from './mocks/fetch_objects'\nimport { newService, policiesList } from './mocks/fetch_policies'\n\nexport const auth = axios.create({\n\tbaseURL: process.env.REACT_APP_API_URL\n})\n\nexport const rest = axios.create({\n\tbaseURL: process.env.REACT_APP_API_URL,\n\ttransformResponse: [\n\t\t...axios.defaults.transformResponse,\n\t\tdata => humps.camelizeKeys(data)\n\t]\n})\n\nrest.interceptors.request.use(\n\tconfig => {\n\t\tconst token = localStorage.getItem(LOCAL_ACCESS_TOKEN_KEY)\n\n\t\tif (token === null) {\n\t\t\tstore.dispatch(logoutUser())\n\t\t\treturn config\n\t\t}\n\t\tconfig.headers.Authorization = `Bearer ${token}`\n\n\t\treturn config\n\t},\n\terr => Promise.reject(err)\n)\n\nrest.interceptors.response.use(\n\tresponse => {\n\t\tstore.dispatch(renewToken())\n\t\treturn response\n\t},\n\terror => {\n\t\tif (error.status === 401) {\n\t\t\tlocalStorage.removeItem(LOCAL_ACCESS_TOKEN_KEY)\n\t\t\tstore.dispatch(logoutUser())\n\t\t}\n\t\treturn Promise.reject(error)\n\t}\n)\n\nif (process.env.REACT_APP_ENABLE_MOCK === 'true') {\n\tconst readUserMockReponse = require('./mocks/read_user')\n\tconst createUserMockReponse = require('./mocks/create_user')\n\tconst fulfillUserMockResponse = require('./mocks/fulfill_user')\n\tconst restMock = new MockAdapter(rest, { delayResponse: 300 })\n\trestMock\n\t\t.onGet('/ecosystems/00790f55-a0a5-f4a4-6041-f291324f89a1/objects')\n\t\t.reply(200, list)\n\t\t.onGet('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/policies')\n\t\t.reply(200, policiesList)\n\t\t.onPost('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/policies')\n\t\t.reply(200, {})\n\t\t.onPost('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/services')\n\t\t.reply(201, newService)\n\t\t.onPost('/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/objects')\n\t\t.reply(201, newOne)\n\t\t.onPut(\n\t\t\t'/ecosystems/e6960bd4-2275-4d55-a1e7-a9101e79ba36/objects/2ewsvw234ewrdsf'\n\t\t)\n\t\t.reply(400)\n\t\t.onGet(new RegExp('/v2/users/*'))\n\t\t.reply(readUserMockReponse)\n\t\t.onPut(new RegExp('/v2/users/*'))\n\t\t.reply(fulfillUserMockResponse)\n\t\t.onAny()\n\t\t.passThrough()\n\n\tconst authMock = new MockAdapter(auth, { delayResponse: 300 })\n\tauthMock.onPost(`v2/users`).reply(createUserMockReponse)\n}\n\nexport function fetchEcosystems({ customer }) {\n\treturn rest\n\t\t.get(`/v2/customers/${customer}/ecosystems`)\n\t\t.then(response => response.data)\n}\n\nexport function createEcosystem({ customer, entity }) {\n\treturn rest\n\t\t.post(`/v2/customers/${customer}/ecosystems`, {\n\t\t\tname: entity.name,\n\t\t\tnsps: ['EWR1']\n\t\t})\n\t\t.then(response => response.data)\n}\n\nexport function fetchObjects({ ecosystem }) {\n\treturn rest\n\t\t.get(`/ecosystems/${ecosystem.uuid}/objects`)\n\t\t.then(response => response.data)\n}\n\nexport function fetchPolicies({ ecosystem }) {\n\treturn rest\n\t\t.get(`/ecosystems/${ecosystem.uuid}/policies`)\n\t\t.then(response => response.data)\n}\n\nexport function createObject(object, type) {\n\treturn rest.post(getUrlForType(type), object).then(response => response.data)\n}\n\nexport function updateObject(object) {\n\treturn rest.put(`${getUrlForType(object.element)}/${object.id}`, object)\n}\n\nexport function createService(service, ecosystem) {\n\treturn rest\n\t\t.post(`/ecosystems/${ecosystem.uuid}/services`, service)\n\t\t.then(response => response.data)\n}\n\nexport function createPolicy(policy, ecosystem) {\n\treturn rest\n\t\t.post(`/ecosystems/${ecosystem.uuid}/policies`, policy)\n\t\t.then(response => response.data)\n}\n\nexport function login(credentials) {\n\treturn auth.post(`v2/auth/login`, credentials).then(response => response.data)\n}\n\nexport function logout() {\n\treturn rest.post(`/v2/auth/logout`, {}).then(response => response.data)\n}\n\nexport async function fetchReports({ query, ecosystem, customer }) {\n\tconst hits = await rest\n\t\t.post(\n\t\t\t`/v2/customers/${customer}/ecosystems/${ecosystem}/logs/_search`,\n\t\t\tquery\n\t\t)\n\t\t.then(response => {\n\t\t\treturn response.data.hits.hits\n\t\t})\n\treturn hits\n\t\t.map(report => ({ ...report.source, id: report.id }))\n\t\t.map(report => {\n\t\t\treturn {\n\t\t\t\tid: report.id,\n\t\t\t\tdate: report.eventDatetime,\n\t\t\t\tpolicy: report.policyID,\n\t\t\t\tsource: report.sourceGeography,\n\t\t\t\tservice: {\n\t\t\t\t\tprotocol: '',\n\t\t\t\t\tport: report.destinationPort,\n\t\t\t\t\ttcp: 'UDP',\n\t\t\t\t\tstatus: ''\n\t\t\t\t},\n\t\t\t\tapplication: '',\n\t\t\t\tdestination: report.destinationGeography,\n\t\t\t\tactions: [report.eventAction],\n\t\t\t\talert: 'Threat',\n\t\t\t\tstatus: 'active'\n\t\t\t}\n\t\t})\n}\n\n// TODO: it's mocked\nfunction getUrlForType(\n\ttype,\n\tecosystem = 'e6960bd4-2275-4d55-a1e7-a9101e79ba36'\n) {\n\treturn `/ecosystems/${ecosystem}/objects`\n}\n"]},"metadata":{},"sourceType":"module"}