{"version":3,"sources":["components/Table/Table.jsx","assets/img/PNG/Acreto_Icon 16.png","assets/img/PNG/Acreto_Icon 17.png","assets/img/PNG/Acreto_Icon 13.png","assets/img/PNG/Acreto_Icon 18.png","assets/img/PNG/Acreto_Icon 23.png","assets/img/PNG/Acreto_Icon 24.png","assets/img/PNG/policy_icon.png","views/Reports/components/ReportsTableItem/ReportTableItem.js","views/Reports/components/SearchBar/SearchBar.js","api/elasticsearch.js","store/reports/actions.js","views/Reports/scenario-actions.js","views/Reports/Reports.jsx"],"names":["classnames__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","classnames__WEBPACK_IMPORTED_MODULE_0___default","n","react__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_1___default","react_responsive__WEBPACK_IMPORTED_MODULE_2__","react_responsive__WEBPACK_IMPORTED_MODULE_2___default","HeaderItem","_ref3","conf","divider","a","createElement","className","cx","field","text-center","center","name","__webpack_exports__","Content","_ref2","root","headerComponent","renderItems","concat","minWidth","maxWidth","matches","Container","_ref","children","Header","_ref4","items","map","index","key","module","exports","p","getIconForAction","action","AllowIcon","ChainIcon","TableItemContainer","react_default","Field","_ref2$extraClass","extraClass","ResponsiveField","title","_ref3$extraClass","PolicyField","date","Fragment","src","ArrowLeftBottomIcon","alt","PolicyIcon","moment","format","SmallTextField","_ref5","text","ServiceField","_ref6","service","ServiceIcon","tcp","port","protocol","ApplicationField","_ref7","application","ApplicationIcon","ActionsField","_ref8","actions","AlertField","_ref9","alert","ThreatIcon","StatusField","_ref10","status","icon","ReportsTableItem","_ref11","data","_ref11$responsive","responsive","REPORT_STATUSES","find","s","slug","WrapperComponent","source","destination","SearchBar","state","value","handleChange","e","_this","setState","target","Dropdown","id","Toggle","bsStyle","Menu","rate","MenuItem","active","Glyphicon","glyph","placeholder","this","onChange","React","Component","elasticsearch","axios","create","baseURL","process","REPORTS_INDEX","fetchReports","_x","_fetchReports","apply","arguments","_callee","query","hits","regenerator_default","wrap","_context","prev","next","post","then","response","sent","abrupt","report","Object","objectSpread","_source","_id","EventDatetime","policy","PolicyID","SourceID","DestinationPort","DestinationID","EventAction","stop","fetchingReportsStarted","type","FETCHING_REPORTS_REQUESTED","fetchingReportsSuccess","results","append","length","undefined","FETCHING_REPORTS_SUCCESS","payload","fetchingReportsFailed","err","FETCHING_REPORTS_FAILURE","message","REPORTS_PER_PAGE","rateOptions","Reports","props","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","startSyncingInterval","rateTime","interval","clearInterval","setInterval","fetchNewest","handleChangeRefreshRate","changeFilter","val","filter","handleRefresh","renderRefreshRateDropdown","onSelect","renderFilterButtons","ButtonGroup","Button","onClick","renderReports","item","SearchBar_SearchBar","Table","REPORT_TABLE_FIELDS","isLoading","fetchOlder","Loader","defaultProps","loadingSelector","createLoadingSelector","errorSelector","createErrorMessageSelector","connect","reports","error","dispatch","asyncToGenerator","mark","getState","api","ecosystem","ecosystems","currentecosystem","uuid","customer","auth","selectedCustomer","bool","must","match_all","sort","order","size","t0","_x2","_callee2","element","_context2","ES","range","gt","_x3","_x4","_callee3","_context3","lt","_x5","_x6"],"mappings":"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","file":"static/js/2.8c75a463.chunk.js","sourcesContent":["import cx from 'classnames'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport MediaQuery from 'react-responsive'\nimport './table.scss'\n\nfunction Container({ children, root }) {\n\treturn (\n\t\t<div className={`table-container ${root}__table-container`}>{children}</div>\n\t)\n}\n\nfunction Content({ root, headerComponent, renderItems }) {\n\treturn (\n\t\t<div className={`table-content ${root}__table-content`}>\n\t\t\t<MediaQuery minWidth={992}>{headerComponent}</MediaQuery>\n\t\t\t<MediaQuery maxWidth={991}>{matches => renderItems(matches)}</MediaQuery>\n\t\t</div>\n\t)\n}\n\nfunction HeaderItem({ conf }) {\n\tif (conf.divider) {\n\t\treturn <div className={`empty`} />\n\t}\n\n\treturn (\n\t\t<div className={cx({ field: true, 'text-center': conf.center })}>\n\t\t\t{conf.name}\n\t\t</div>\n\t)\n}\n\nfunction Header({ items }) {\n\treturn (\n\t\t<div className={`table-header header`}>\n\t\t\t{items.map((field, index) => (\n\t\t\t\t<HeaderItem conf={field} key={`table-header-field-${index}`} />\n\t\t\t))}\n\t\t</div>\n\t)\n}\n\nContainer.propTypes = {\n\tchildren: PropTypes.element,\n\troot: PropTypes.string\n}\n\nContent.propTypes = {\n\troot: PropTypes.string,\n\theaderComponent: PropTypes.element.isRequired,\n\trenderItems: PropTypes.func.isRequired\n}\n\nHeader.propTypes = {\n\titems: PropTypes.array.isRequired\n}\n\nHeaderItem.propTypes = {\n\tconf: PropTypes.object.isRequired\n}\n\nexport default {\n\tContent,\n\tContainer,\n\tHeader\n}\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN1JREFUeNpi/P//PwO1ARMDDcAIN5SFGEV/NjoKAKkEIHYA4gdAfIDFf/8GXOoZCcU+0EADILUBatgCIFYA4nogvgiyBGj4B3K8PwHqMpArLyAZeIAsl0K9/R5oICOUPwEcZv77CyiJKJDXD6Lx0S0lOaIM0PggFx4AGgYKCn2Yb4k2FKgRFNsN0BhngHr7AlBcAWqZA7IcQUOhBk6Axu4FpFQAAh+ghoFcHUCK9xPQDIRZAjJQABrzcHly0imGqwkBQknKgJCryIl9UC4yABr4gJS8zzhaSFMdAAQYAD1zW35rCdoxAAAAAElFTkSuQmCC\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHlJREFUeNpi/P//PwO1ARMDDcAIN5QFXSD28GsFIJVApP4Li21FNxDjUpCBDkQYCLK8gCiXQsEBoAsa8JkI9BHI4oZhFlFAYADE/kDv1ROh/yWxhl6AxuoIDVMQcAB6r4GIdEq0oQuIdNADIN6ATYJxtDwdGoYCBBgAN0MgTCbrTGkAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAItJREFUeNpi/P//PwM1ARMDlcEwNrC8c4IBEAtQxUCgQQlA6jwQK1BsINSw+UCc2FlecIEiA9EMW0BRGBJjGFYDoYG9gRzDcLlQAIpJNoygl0k1DK+B5BiGz0ARcgwDAUb00gboMgcgtQWIHwDxGySpD0DDAwgZyIJFDJRYfbCIfyDLhaPFF8kAIMAAi5tC3u698loAAAAASUVORK5CYII=\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOdJREFUeNpi/P//PwO1ARMDDcBwNDQ6OgCIBYhRykhUREVHHwCSCkD8AYgdGJYu/UCZS6OjG8D00qUgQx8A8QTKvB8dDTKoAIpBIAGIQcHgQIlLQa5aAHTlBaBB/6HebiDkWiY8rnQAhx/EEARYunQCVL6AHJcuAHsbe6QUgC3DkRqY8ETOA6CBC7DKL10KSg0bcAUDExGRAwMH0fgNuCINm0sb4JGDCg5ALYS5Fpa8GvAbCtEUgE0hjmBoAGeK6GgDZGEWNGUK8IiIjsZmTAKauAASxpNNEUmJWIARoYyjhTTVAUCAAQDmIkrnRfoIAAAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAfJJREFUeNpi/P//PwO1ARMDDQBNDGXBJ3n7+7sSJkbG+H///4uyMTFzMzIwvP3+788TVkbmDiUOgS249DHiCFODF7++7N794b7IopeXGJ7++gyX0OASYUgS1/9lyCPxWJqN1wQo9IGgoZe/vrIVZ+Pek3FnO9uNb29w+sJZQJEhT8r0pSqnkAa6weiGCjz79fluzt2dQvgMRDa4QtbqLtDFKjgj6t6PDx3r397EayDI+zCw98N9hvNfXsgC9fngNJSLiSV40cvLOA0045ViWKjmhyI27+VFNmZGxiachr7784Pl89+fOA3NljRhWPTqEooYyFesjEzyRKfTbCkTuHdBrgSxsfnkw5+fTEQb+uznZ7B3QQbCXInNJ7zMbIw4E78AC/s/ZD4w0sD0AqDBn//+YgCmCgwDgTHPAMwgb3Aa+uPf34uBwuqOMMNgBn8CGgjSjM2VASLqDN/+/p6BL50qPPz58XLY9XU8+CIM2ZUL1f3eSbHxCuML0we//v1tXKzu/5eXmZ2ggX1Krl/e/v4eQLCUAma7HqArm1ZoBH4H5RhsABhEDCs1g74BmV663GKHiS1QwEFx8/vbJVxMrDof/vxgPvTpEY8dn9wXYVbOX+///NiszSVagK0wIWQoSsIAlVxAfAGXQeQYOvAlP0CAAQCw69QuJPSVeQAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAONJREFUeNpi/P//PwO1ARMDDcAIN5SFWIV5XVMVgNQCILYH4oMg9qSy7AWUuvQCEH8AYkWo4ROAFjVQ5FIgCAC67ACUvQBoIIieAMQNJBkK1CgApAqg+ACQ/wFo8AWo9AOoy4n3PtAAA6hGEO0AMhSIE5Asw+pKEGDElqOgmkCGXAC6LIFYOULen4CsCeRtaOQ8gLoOFPMFRCcpaNKJB2JBJGEDqGGgYHBAClei0yks8EEGbEASm0DIMEJh2gCN8QaogSB6Az4vEzQUarADNLZBwXEAaGADsQmacbQ8HRqGAgQYAPn6XA4FqkQfAAAAAElFTkSuQmCC\"","module.exports = __webpack_public_path__ + \"static/media/policy_icon.e920d8c4.png\";","import moment from 'moment'\nimport PropTypes from 'prop-types'\nimport React from 'react'\nimport ArrowLeftBottomIcon from '../../../../assets/img/PNG/Acreto_Icon 13.png'\nimport ServiceIcon from '../../../../assets/img/PNG/Acreto_Icon 16.png'\nimport ApplicationIcon from '../../../../assets/img/PNG/Acreto_Icon 17.png'\nimport ThreatIcon from '../../../../assets/img/PNG/Acreto_Icon 18.png'\nimport AllowIcon from '../../../../assets/img/PNG/Acreto_Icon 23.png'\nimport ChainIcon from '../../../../assets/img/PNG/Acreto_Icon 24.png'\nimport PolicyIcon from '../../../../assets/img/PNG/policy_icon.png'\nimport { REPORT_STATUSES } from '../../../../enums'\n\nimport './reports-table-item.scss'\n\nconst getIconForAction = action => {\n\tswitch (action) {\n\t\tcase 'Allow':\n\t\t\treturn AllowIcon\n\t\tcase 'URL':\n\t\t\treturn ChainIcon\n\t\tdefault:\n\t\t\treturn AllowIcon\n\t}\n}\n\nfunction TableItemContainer({ children }) {\n\treturn <div className={'reports-table-item item'}>{children}</div>\n}\n\nfunction Field({ children, extraClass = '' }) {\n\treturn <div className={`field ${extraClass}`}>{children}</div>\n}\n\nfunction ResponsiveField({ children, title, extraClass = '' }) {\n\treturn (\n\t\t<div className={`field ${extraClass}`}>\n\t\t\t<p className={'field__title'}>{title}</p>\n\t\t\t<div className={'field__content'}>{children}</div>\n\t\t</div>\n\t)\n}\n\nfunction PolicyField({ date }) {\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<img\n\t\t\t\tsrc={ArrowLeftBottomIcon}\n\t\t\t\talt={'arrow-icon'}\n\t\t\t\tclassName={'small-icon'}\n\t\t\t/>\n\t\t\t<img src={PolicyIcon} alt={'policy-icon'} className={'small-icon'} />\n\t\t\t<div>\n\t\t\t\t<p className={'medium'}>{moment(date).format('HH:mm:ss')}</p>\n\t\t\t\t<p className={'medium'}>{moment(date).format('DD/MM/YYYY')}</p>\n\t\t\t</div>\n\t\t</React.Fragment>\n\t)\n}\n\nfunction SmallTextField({ text }) {\n\treturn <p className={'small'}>{text}</p>\n}\n\nfunction ServiceField({ service }) {\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<img src={ServiceIcon} alt={'service-icon'} className={'small-icon'} />\n\t\t\t<div>\n\t\t\t\t<p className={'medium strong'}>{`${service.tcp ? 'TCP' : 'UDP'}/${\n\t\t\t\t\tservice.port\n\t\t\t\t}`}</p>\n\t\t\t\t<p className={'small'}>{`(${service.protocol})`}</p>\n\t\t\t</div>\n\t\t</React.Fragment>\n\t)\n}\n\nfunction ApplicationField({ application }) {\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<img\n\t\t\t\tsrc={ApplicationIcon}\n\t\t\t\talt={'application-icon'}\n\t\t\t\tclassName={'small-icon'}\n\t\t\t/>\n\t\t\t<p className={'medium strong'}>{application}</p>\n\t\t</React.Fragment>\n\t)\n}\n\nfunction ActionsField({ actions }) {\n\treturn (\n\t\t<React.Fragment>\n\t\t\t{actions.map(action => (\n\t\t\t\t<div className={'action'} key={`action-item-index-${action}`}>\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc={getIconForAction(action)}\n\t\t\t\t\t\talt={'icon'}\n\t\t\t\t\t\tclassName={'small-icon'}\n\t\t\t\t\t/>\n\t\t\t\t\t<p className={'medium'}>{action}</p>\n\t\t\t\t</div>\n\t\t\t))}\n\t\t</React.Fragment>\n\t)\n}\n\nfunction AlertField({ alert }) {\n\treturn (\n\t\t<React.Fragment>\n\t\t\t{alert ? (\n\t\t\t\t<React.Fragment>\n\t\t\t\t\t<img src={ThreatIcon} alt={'alert-icon'} className={'small-icon'} />\n\t\t\t\t\t<p className={'medium'}>{alert}</p>\n\t\t\t\t</React.Fragment>\n\t\t\t) : (\n\t\t\t\t<p className={'strong'}>-</p>\n\t\t\t)}\n\t\t</React.Fragment>\n\t)\n}\n\nfunction StatusField({ status }) {\n\treturn (\n\t\t<React.Fragment>\n\t\t\t<img src={status.icon} alt={'status-icon'} className={'small-icon'} />\n\t\t\t<p className={'medium'}>{status.name}</p>\n\t\t</React.Fragment>\n\t)\n}\n\nexport default function ReportsTableItem({ data, responsive = false }) {\n\tconst status = REPORT_STATUSES.find(s => s.slug === data.status)\n\n\tconst WrapperComponent = responsive ? ResponsiveField : Field\n\treturn (\n\t\t<TableItemContainer>\n\t\t\t<WrapperComponent title={'Policy'} extraClass={'field__policy'}>\n\t\t\t\t<PolicyField date={data.date} />\n\t\t\t</WrapperComponent>\n\t\t\t<WrapperComponent title={'Source'} extraClass={'field__source'}>\n\t\t\t\t<SmallTextField text={data.source} />\n\t\t\t</WrapperComponent>\n\t\t\t<WrapperComponent title={'Service'} extraClass={'field__service'}>\n\t\t\t\t<ServiceField service={data.service} />\n\t\t\t</WrapperComponent>\n\t\t\t<WrapperComponent title={'Application'} extraClass={'field__application'}>\n\t\t\t\t<ApplicationField application={data.application} />\n\t\t\t</WrapperComponent>\n\t\t\t<WrapperComponent title={'Destination'} extraClass={'field__destination'}>\n\t\t\t\t<SmallTextField text={data.destination} />\n\t\t\t</WrapperComponent>\n\t\t\t<WrapperComponent title={'Actions'} extraClass={'field__actions'}>\n\t\t\t\t<ActionsField actions={data.actions} />\n\t\t\t</WrapperComponent>\n\t\t\t<WrapperComponent title={'Alert'} extraClass={'field__alert'}>\n\t\t\t\t<AlertField alert={data.alert} />\n\t\t\t</WrapperComponent>\n\t\t\t<WrapperComponent title={'Status'} extraClass={'field__status'}>\n\t\t\t\t<StatusField status={status} />\n\t\t\t</WrapperComponent>\n\t\t</TableItemContainer>\n\t)\n}\n\nStatusField.propTypes = {\n\tstatus: PropTypes.object.isRequired\n}\n\nAlertField.propTypes = {\n\talert: PropTypes.any.isRequired\n}\n\nActionsField.propTypes = {\n\tactions: PropTypes.array.isRequired\n}\n\nApplicationField.propTypes = {\n\tapplication: PropTypes.string.isRequired\n}\n\nServiceField.propTypes = {\n\tservice: PropTypes.object.isRequired\n}\n\nResponsiveField.propTypes = {\n\tchildren: PropTypes.element.isRequired,\n\ttitle: PropTypes.string.isRequired,\n\textraClass: PropTypes.string\n}\n\nField.propTypes = {\n\tchildren: PropTypes.element.isRequired,\n\textraClass: PropTypes.string\n}\n\nSmallTextField.propTypes = {\n\ttext: PropTypes.string.isRequired\n}\n\nPolicyField.propTypes = {\n\tdate: PropTypes.string.isRequired\n}\n\nTableItemContainer.propTypes = {\n\tchildren: PropTypes.array.isRequired\n}\n\nReportsTableItem.propTypes = {\n\tdata: PropTypes.object.isRequired,\n\tresponsive: PropTypes.bool.isRequired\n}\n","import React from 'react'\nimport { Dropdown, Glyphicon, MenuItem } from 'react-bootstrap'\nimport './search-bar.scss'\n\nexport default class SearchBar extends React.Component {\n\tstate = {\n\t\tvalue: ''\n\t}\n\n\thandleChange = e => {\n\t\tthis.setState({\n\t\t\tvalue: e.target.value\n\t\t})\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className={'search-bar component-coming-soon'}>\n\t\t\t\t<Dropdown id={'dropdown-refresh-rate'}>\n\t\t\t\t\t<Dropdown.Toggle bsStyle={'primary'} id=\"dropdown-basic\">\n\t\t\t\t\t\t{'All'}\n\t\t\t\t\t</Dropdown.Toggle>\n\t\t\t\t\t<Dropdown.Menu>\n\t\t\t\t\t\t{['All', 'Some', 'Any'].map(rate => (\n\t\t\t\t\t\t\t<MenuItem active={rate === 'All'} key={`rate-index-item-${rate}`}>\n\t\t\t\t\t\t\t\t{rate}\n\t\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</Dropdown.Menu>\n\t\t\t\t</Dropdown>\n\t\t\t\t<Glyphicon className={'small-icon'} glyph=\"search\" />\n\t\t\t\t<input\n\t\t\t\t\tplaceholder={'Search'}\n\t\t\t\t\tvalue={this.state.value}\n\t\t\t\t\tonChange={this.handleChange}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t)\n\t}\n}\n","import axios from 'axios'\n\nconst elasticsearch = axios.create({\n\tbaseURL: process.env.REACT_APP_ES_CLUSTER_URL\n})\n\nconst REPORTS_INDEX = 'elastictest'\n\nexport async function fetchReports(query) {\n\tconst hits = await elasticsearch\n\t\t.post(`${REPORTS_INDEX}/_search`, query)\n\t\t.then(response => {\n\t\t\treturn response.data.hits.hits\n\t\t})\n\treturn hits\n\t\t.map(report => ({ ...report._source, id: report._id }))\n\t\t.map(report => {\n\t\t\treturn {\n\t\t\t\tid: report.id,\n\t\t\t\tdate: report.EventDatetime,\n\t\t\t\tpolicy: report.PolicyID,\n\t\t\t\tsource: report.SourceID,\n\t\t\t\tservice: {\n\t\t\t\t\tprotocol: '',\n\t\t\t\t\tport: report.DestinationPort,\n\t\t\t\t\ttcp: 'UDP',\n\t\t\t\t\tstatus: ''\n\t\t\t\t},\n\t\t\t\tapplication: '',\n\t\t\t\tdestination: report.DestinationID,\n\t\t\t\tactions: [report.EventAction],\n\t\t\t\talert: 'Threat',\n\t\t\t\tstatus: 'active'\n\t\t\t}\n\t\t})\n}\n","import {\n\tFETCHING_REPORTS_FAILURE,\n\tFETCHING_REPORTS_REQUESTED,\n\tFETCHING_REPORTS_SUCCESS\n} from './action-types'\n\nexport function fetchingReportsStarted() {\n\treturn {\n\t\ttype: FETCHING_REPORTS_REQUESTED\n\t}\n}\n\nexport function fetchingReportsSuccess(results, append = false) {\n\treturn {\n\t\ttype: FETCHING_REPORTS_SUCCESS,\n\t\tpayload: {\n\t\t\tresults,\n\t\t\tappend\n\t\t}\n\t}\n}\n\nexport function fetchingReportsFailed(err) {\n\treturn {\n\t\ttype: FETCHING_REPORTS_FAILURE,\n\t\tpayload: {\n\t\t\tmessage: err\n\t\t}\n\t}\n}\n","import * as ES from '../../api/elasticsearch'\nimport * as api from '../../api/rest'\nimport {\n\tfetchingReportsFailed,\n\tfetchingReportsStarted,\n\tfetchingReportsSuccess\n} from '../../store/reports/actions'\n\nconst REPORTS_PER_PAGE = process.env.REACT_APP_REPORTS_PER_PAGE || 50\n\nexport function fetchReports() {\n\treturn async (dispatch, getState) => {\n\t\ttry {\n\t\t\tdispatch(fetchingReportsStarted())\n\t\t\tconst reports = await api.fetchReports({\n\t\t\t\tecosystem: getState().ecosystems.currentecosystem.uuid,\n\t\t\t\tcustomer: getState().auth.selectedCustomer.id,\n\t\t\t\tquery: {\n\t\t\t\t\tquery: {\n\t\t\t\t\t\tbool: {\n\t\t\t\t\t\t\tmust: {\n\t\t\t\t\t\t\t\tmatch_all: {}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tsort: {\n\t\t\t\t\t\tEventDatetime: { order: 'asc' }\n\t\t\t\t\t},\n\t\t\t\t\tsize: REPORTS_PER_PAGE\n\t\t\t\t}\n\t\t\t})\n\t\t\tdispatch(fetchingReportsSuccess(reports))\n\t\t} catch (err) {\n\t\t\tdispatch(fetchingReportsFailed(err))\n\t\t}\n\t}\n}\n\nexport function fetchNewest() {\n\treturn async (dispatch, getState) => {\n\t\tconst element = getState().reports.items[0]\n\t\ttry {\n\t\t\tdispatch(fetchingReportsStarted())\n\t\t\tconst results = await ES.fetchReports({\n\t\t\t\tquery: {\n\t\t\t\t\tbool: {\n\t\t\t\t\t\tmust: { match_all: {} },\n\t\t\t\t\t\tfilter: {\n\t\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\t\tEventDatetime: {\n\t\t\t\t\t\t\t\t\tgt: element.date\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsort: {\n\t\t\t\t\tEventDatetime: { order: 'desc' }\n\t\t\t\t},\n\t\t\t\tsize: REPORTS_PER_PAGE\n\t\t\t})\n\t\t\tdispatch(fetchingReportsSuccess(results, true))\n\t\t} catch (err) {\n\t\t\tdispatch(fetchingReportsFailed())\n\t\t}\n\t}\n}\n\nexport function fetchOlder() {\n\treturn async (dispatch, getState) => {\n\t\tconst element = getState().reports.items[\n\t\t\tgetState().reports.items.length - 1\n\t\t]\n\t\ttry {\n\t\t\tdispatch(fetchingReportsStarted())\n\t\t\tconst results = await ES.fetchReports({\n\t\t\t\tquery: {\n\t\t\t\t\tbool: {\n\t\t\t\t\t\tmust: { match_all: {} },\n\t\t\t\t\t\tfilter: {\n\t\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\t\tEventDatetime: {\n\t\t\t\t\t\t\t\t\tlt: element.date\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tsort: {\n\t\t\t\t\tEventDatetime: { order: 'desc' }\n\t\t\t\t},\n\t\t\t\tsize: REPORTS_PER_PAGE\n\t\t\t})\n\t\t\tdispatch(fetchingReportsSuccess(results, true))\n\t\t} catch (err) {\n\t\t\tdispatch(fetchingReportsFailed())\n\t\t}\n\t}\n}\n","import PropTypes from 'prop-types'\nimport React, { Component } from 'react'\nimport {\n\tButton,\n\tButtonGroup,\n\tDropdown,\n\tGlyphicon,\n\tMenuItem\n} from 'react-bootstrap'\nimport { connect } from 'react-redux'\nimport Loader from '../../components/Loader/Loader'\nimport Table from '../../components/Table/Table'\nimport { REPORT_TABLE_FIELDS } from '../../enums'\nimport {\n\tcreateErrorMessageSelector,\n\tcreateLoadingSelector\n} from '../../store/utils/selectors'\nimport ReportsTableItem from './components/ReportsTableItem/ReportTableItem'\nimport SearchBar from './components/SearchBar/SearchBar'\nimport './reports.scss'\nimport { fetchNewest, fetchOlder, fetchReports } from './scenario-actions'\n\nconst rateOptions = [\n\t{\n\t\tvalue: 0,\n\t\ttext: 'Freeze'\n\t},\n\t{\n\t\tvalue: 5,\n\t\ttext: '30 seconds'\n\t},\n\t{\n\t\tvalue: 60,\n\t\ttext: 'Every minute'\n\t}\n]\n\nclass Reports extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\trate: { value: 0, text: 'Freeze' },\n\t\t\tfilter: 0,\n\t\t\tinterval: null\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.props.fetchReports()\n\t\tthis.startSyncingInterval()\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearInterval(this.state.interval)\n\t}\n\n\tstartSyncingInterval = () => {\n\t\tconst rateTime = this.state.rate.value\n\t\tif (this.state.interval) {\n\t\t\tclearInterval(this.state.interval)\n\t\t}\n\t\tif (rateTime !== 0) {\n\t\t\tconst interval = setInterval(() => {\n\t\t\t\tthis.props.fetchNewest()\n\t\t\t}, rateTime * 1000)\n\t\t\tthis.setState({\n\t\t\t\tinterval\n\t\t\t})\n\t\t}\n\t}\n\n\thandleChangeRefreshRate = rate => {\n\t\tthis.setState({ rate }, () => {\n\t\t\tthis.startSyncingInterval()\n\t\t})\n\t}\n\n\tchangeFilter = val => {\n\t\tthis.setState({\n\t\t\tfilter: val\n\t\t})\n\t}\n\n\thandleRefresh = () => {\n\t\tthis.props.fetchReports()\n\t}\n\n\trenderRefreshRateDropdown = () => (\n\t\t<div className={'reports__filters-refresh'}>\n\t\t\t<p>Refresh: </p>\n\t\t\t<Dropdown id={'dropdown-refresh-rate'}>\n\t\t\t\t<Dropdown.Toggle id=\"dropdown-basic\">\n\t\t\t\t\t{this.state.rate.text}\n\t\t\t\t</Dropdown.Toggle>\n\n\t\t\t\t<Dropdown.Menu>\n\t\t\t\t\t{rateOptions.map(rate => (\n\t\t\t\t\t\t<MenuItem\n\t\t\t\t\t\t\tactive={rate.value === this.state.rate.value}\n\t\t\t\t\t\t\tkey={`rate-index-item-${rate.value}`}\n\t\t\t\t\t\t\tonSelect={() => this.handleChangeRefreshRate(rate)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{rate.text}\n\t\t\t\t\t\t</MenuItem>\n\t\t\t\t\t))}\n\t\t\t\t</Dropdown.Menu>\n\t\t\t</Dropdown>\n\t\t</div>\n\t)\n\n\trenderFilterButtons = () => {\n\t\tconst { filter } = this.state\n\t\treturn (\n\t\t\t<ButtonGroup className={'reports__filters-buttons'}>\n\t\t\t\t<Button\n\t\t\t\t\tonClick={() => this.changeFilter(0)}\n\t\t\t\t\tbsStyle={filter === 0 ? 'primary' : 'default'}\n\t\t\t\t>\n\t\t\t\t\tAll\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tonClick={() => this.changeFilter(1)}\n\t\t\t\t\tbsStyle={filter === 1 ? 'primary' : 'default'}\n\t\t\t\t>\n\t\t\t\t\tAllowed\n\t\t\t\t</Button>\n\t\t\t\t<Button\n\t\t\t\t\tonClick={() => this.changeFilter(2)}\n\t\t\t\t\tbsStyle={filter === 2 ? 'primary' : 'default'}\n\t\t\t\t>\n\t\t\t\t\tAlert\n\t\t\t\t</Button>\n\t\t\t</ButtonGroup>\n\t\t)\n\t}\n\n\trenderReports = matches => {\n\t\tconst { items } = this.props\n\t\treturn items.map(item => (\n\t\t\t<ReportsTableItem\n\t\t\t\tkey={`reports-table-item-${item.id}-${item.date}`}\n\t\t\t\tresponsive={matches}\n\t\t\t\tdata={item}\n\t\t\t/>\n\t\t))\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<div className=\"content reports\">\n\t\t\t\t<div className={'reports__search-bar'}>\n\t\t\t\t\t<SearchBar />\n\t\t\t\t</div>\n\t\t\t\t<div className={'reports__filters'}>\n\t\t\t\t\t<div className={'left-container'}>\n\t\t\t\t\t\t<p>Realtime View</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className={'right-container'}>\n\t\t\t\t\t\t{this.renderRefreshRateDropdown()}\n\t\t\t\t\t\t<Glyphicon\n\t\t\t\t\t\t\tclassName={'small-icon refresh-button'}\n\t\t\t\t\t\t\tglyph=\"repeat\"\n\t\t\t\t\t\t\tonClick={this.handleRefresh}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t{this.renderFilterButtons()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Table.Container root={'reports'}>\n\t\t\t\t\t<Table.Content\n\t\t\t\t\t\troot={'reports'}\n\t\t\t\t\t\theaderComponent={<Table.Header items={REPORT_TABLE_FIELDS} />}\n\t\t\t\t\t\trenderItems={this.renderReports}\n\t\t\t\t\t/>\n\t\t\t\t</Table.Container>\n\t\t\t\t{this.props.items.length !== 0 && !this.props.isLoading && (\n\t\t\t\t\t<p onClick={this.props.fetchOlder} className={'reports__more-button'}>\n\t\t\t\t\t\tLoad older reports\n\t\t\t\t\t</p>\n\t\t\t\t)}\n\t\t\t\t{this.props.isLoading && (\n\t\t\t\t\t<div className={'loader-container'}>\n\t\t\t\t\t\t<Loader />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t)\n\t}\n}\n\nReports.propTypes = {\n\tfetchReports: PropTypes.func.isRequired,\n\tfetchNewest: PropTypes.func.isRequired,\n\tfetchOlder: PropTypes.func.isRequired,\n\titems: PropTypes.array.isRequired,\n\tisLoading: PropTypes.bool.isRequired\n}\n\nReports.defaultProps = {\n\titems: []\n}\n\nconst loadingSelector = createLoadingSelector(['FETCHING_REPORTS'])\nconst errorSelector = createErrorMessageSelector(['FETCHING_REPORTS'])\nconst mapStateToProps = state => {\n\treturn {\n\t\titems: state.reports.items,\n\t\tisLoading: loadingSelector(state),\n\t\terror: errorSelector(state)\n\t}\n}\n\nconst mapDispatchToProps = dispatch => {\n\treturn {\n\t\tfetchReports: () => dispatch(fetchReports()),\n\t\tfetchNewest: () => dispatch(fetchNewest()),\n\t\tfetchOlder: () => dispatch(fetchOlder())\n\t}\n}\n\nexport default connect(\n\tmapStateToProps,\n\tmapDispatchToProps\n)(Reports)\n"],"sourceRoot":""}