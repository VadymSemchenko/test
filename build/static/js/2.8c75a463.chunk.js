(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{941:function(e,t,a){"use strict";var n=a(11),r=a.n(n),c=a(0),l=a.n(c),i=a(944),s=a.n(i);a(942);function o(e){var t=e.conf;return t.divider?l.a.createElement("div",{className:"empty"}):l.a.createElement("div",{className:r()({field:!0,"text-center":t.center})},t.name)}t.a={Content:function(e){var t=e.root,a=e.headerComponent,n=e.renderItems;return l.a.createElement("div",{className:"table-content ".concat(t,"__table-content")},l.a.createElement(s.a,{minWidth:992},a),l.a.createElement(s.a,{maxWidth:991},function(e){return n(e)}))},Container:function(e){var t=e.children,a=e.root;return l.a.createElement("div",{className:"table-container ".concat(a,"__table-container")},t)},Header:function(e){var t=e.items;return l.a.createElement("div",{className:"table-header header"},t.map(function(e,t){return l.a.createElement(o,{conf:e,key:"table-header-field-".concat(t)})}))}}},942:function(e,t,a){},945:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN1JREFUeNpi/P//PwO1ARMDDcAIN5SFGEV/NjoKAKkEIHYA4gdAfIDFf/8GXOoZCcU+0EADILUBatgCIFYA4nogvgiyBGj4B3K8PwHqMpArLyAZeIAsl0K9/R5oICOUPwEcZv77CyiJKJDXD6Lx0S0lOaIM0PggFx4AGgYKCn2Yb4k2FKgRFNsN0BhngHr7AlBcAWqZA7IcQUOhBk6Axu4FpFQAAh+ghoFcHUCK9xPQDIRZAjJQABrzcHly0imGqwkBQknKgJCryIl9UC4yABr4gJS8zzhaSFMdAAQYAD1zW35rCdoxAAAAAElFTkSuQmCC"},946:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAHlJREFUeNpi/P//PwO1ARMDDcAIN5QFXSD28GsFIJVApP4Li21FNxDjUpCBDkQYCLK8gCiXQsEBoAsa8JkI9BHI4oZhFlFAYADE/kDv1ROh/yWxhl6AxuoIDVMQcAB6r4GIdEq0oQuIdNADIN6ATYJxtDwdGoYCBBgAN0MgTCbrTGkAAAAASUVORK5CYII="},947:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAItJREFUeNpi/P//PwM1ARMDlcEwNrC8c4IBEAtQxUCgQQlA6jwQK1BsINSw+UCc2FlecIEiA9EMW0BRGBJjGFYDoYG9gRzDcLlQAIpJNoygl0k1DK+B5BiGz0ARcgwDAUb00gboMgcgtQWIHwDxGySpD0DDAwgZyIJFDJRYfbCIfyDLhaPFF8kAIMAAi5tC3u698loAAAAASUVORK5CYII="},948:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAOdJREFUeNpi/P//PwO1ARMDDcBwNDQ6OgCIBYhRykhUREVHHwCSCkD8AYgdGJYu/UCZS6OjG8D00qUgQx8A8QTKvB8dDTKoAIpBIAGIQcHgQIlLQa5aAHTlBaBB/6HebiDkWiY8rnQAhx/EEARYunQCVL6AHJcuAHsbe6QUgC3DkRqY8ETOA6CBC7DKL10KSg0bcAUDExGRAwMH0fgNuCINm0sb4JGDCg5ALYS5Fpa8GvAbCtEUgE0hjmBoAGeK6GgDZGEWNGUK8IiIjsZmTAKauAASxpNNEUmJWIARoYyjhTTVAUCAAQDmIkrnRfoIAAAAAABJRU5ErkJggg=="},949:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAfJJREFUeNpi/P//PwO1ARMDDQBNDGXBJ3n7+7sSJkbG+H///4uyMTFzMzIwvP3+788TVkbmDiUOgS249DHiCFODF7++7N794b7IopeXGJ7++gyX0OASYUgS1/9lyCPxWJqN1wQo9IGgoZe/vrIVZ+Pek3FnO9uNb29w+sJZQJEhT8r0pSqnkAa6weiGCjz79fluzt2dQvgMRDa4QtbqLtDFKjgj6t6PDx3r397EayDI+zCw98N9hvNfXsgC9fngNJSLiSV40cvLOA0045ViWKjmhyI27+VFNmZGxiachr7784Pl89+fOA3NljRhWPTqEooYyFesjEzyRKfTbCkTuHdBrgSxsfnkw5+fTEQb+uznZ7B3QQbCXInNJ7zMbIw4E78AC/s/ZD4w0sD0AqDBn//+YgCmCgwDgTHPAMwgb3Aa+uPf34uBwuqOMMNgBn8CGgjSjM2VASLqDN/+/p6BL50qPPz58XLY9XU8+CIM2ZUL1f3eSbHxCuML0we//v1tXKzu/5eXmZ2ggX1Krl/e/v4eQLCUAma7HqArm1ZoBH4H5RhsABhEDCs1g74BmV663GKHiS1QwEFx8/vbJVxMrDof/vxgPvTpEY8dn9wXYVbOX+///NiszSVagK0wIWQoSsIAlVxAfAGXQeQYOvAlP0CAAQCw69QuJPSVeQAAAABJRU5ErkJggg=="},950:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAONJREFUeNpi/P//PwO1ARMDDcAIN5SFWIV5XVMVgNQCILYH4oMg9qSy7AWUuvQCEH8AYkWo4ROAFjVQ5FIgCAC67ACUvQBoIIieAMQNJBkK1CgApAqg+ACQ/wFo8AWo9AOoy4n3PtAAA6hGEO0AMhSIE5Asw+pKEGDElqOgmkCGXAC6LIFYOULen4CsCeRtaOQ8gLoOFPMFRCcpaNKJB2JBJGEDqGGgYHBAClei0yks8EEGbEASm0DIMEJh2gCN8QaogSB6Az4vEzQUarADNLZBwXEAaGADsQmacbQ8HRqGAgQYAPn6XA4FqkQfAAAAAElFTkSuQmCC"},951:function(e,t,a){e.exports=a.p+"static/media/policy_icon.e920d8c4.png"},952:function(e,t,a){},954:function(e,t,a){},956:function(e,t,a){},988:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a(7),c=a(9),l=a(8),i=a(10),s=a(0),o=a.n(s),A=a(992),m=a(978),u=a(573),p=a(219),d=a(979),E=a(23),f=a(75),g=a(941),v=a(15),h=a(64),C=a(29),N=a.n(C),b=a(947),B=a.n(b),R=a(945),D=a.n(R),F=a(946),w=a.n(F),I=a(948),y=a.n(I),S=a(949),x=a.n(S),Q=a(950),G=a.n(Q),O=a(951),U=a.n(O),J=(a(952),function(e){switch(e){case"Allow":return x.a;case"URL":return G.a;default:return x.a}});function Y(e){var t=e.children;return o.a.createElement("div",{className:"reports-table-item item"},t)}function k(e){var t=e.children,a=e.extraClass,n=void 0===a?"":a;return o.a.createElement("div",{className:"field ".concat(n)},t)}function W(e){var t=e.children,a=e.title,n=e.extraClass,r=void 0===n?"":n;return o.a.createElement("div",{className:"field ".concat(r)},o.a.createElement("p",{className:"field__title"},a),o.a.createElement("div",{className:"field__content"},t))}function Z(e){var t=e.date;return o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:B.a,alt:"arrow-icon",className:"small-icon"}),o.a.createElement("img",{src:U.a,alt:"policy-icon",className:"small-icon"}),o.a.createElement("div",null,o.a.createElement("p",{className:"medium"},N()(t).format("HH:mm:ss")),o.a.createElement("p",{className:"medium"},N()(t).format("DD/MM/YYYY"))))}function P(e){var t=e.text;return o.a.createElement("p",{className:"small"},t)}function M(e){var t=e.service;return o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:D.a,alt:"service-icon",className:"small-icon"}),o.a.createElement("div",null,o.a.createElement("p",{className:"medium strong"},"".concat(t.tcp?"TCP":"UDP","/").concat(t.port)),o.a.createElement("p",{className:"small"},"(".concat(t.protocol,")"))))}function _(e){var t=e.application;return o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:w.a,alt:"application-icon",className:"small-icon"}),o.a.createElement("p",{className:"medium strong"},t))}function V(e){var t=e.actions;return o.a.createElement(o.a.Fragment,null,t.map(function(e){return o.a.createElement("div",{className:"action",key:"action-item-index-".concat(e)},o.a.createElement("img",{src:J(e),alt:"icon",className:"small-icon"}),o.a.createElement("p",{className:"medium"},e))}))}function H(e){var t=e.alert;return o.a.createElement(o.a.Fragment,null,t?o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:y.a,alt:"alert-icon",className:"small-icon"}),o.a.createElement("p",{className:"medium"},t)):o.a.createElement("p",{className:"strong"},"-"))}function T(e){var t=e.status;return o.a.createElement(o.a.Fragment,null,o.a.createElement("img",{src:t.icon,alt:"status-icon",className:"small-icon"}),o.a.createElement("p",{className:"medium"},t.name))}function X(e){var t=e.data,a=e.responsive,n=void 0!==a&&a,r=v.B.find(function(e){return e.slug===t.status}),c=n?W:k;return o.a.createElement(Y,null,o.a.createElement(c,{title:"Policy",extraClass:"field__policy"},o.a.createElement(Z,{date:t.date})),o.a.createElement(c,{title:"Source",extraClass:"field__source"},o.a.createElement(P,{text:t.source})),o.a.createElement(c,{title:"Service",extraClass:"field__service"},o.a.createElement(M,{service:t.service})),o.a.createElement(c,{title:"Application",extraClass:"field__application"},o.a.createElement(_,{application:t.application})),o.a.createElement(c,{title:"Destination",extraClass:"field__destination"},o.a.createElement(P,{text:t.destination})),o.a.createElement(c,{title:"Actions",extraClass:"field__actions"},o.a.createElement(V,{actions:t.actions})),o.a.createElement(c,{title:"Alert",extraClass:"field__alert"},o.a.createElement(H,{alert:t.alert})),o.a.createElement(c,{title:"Status",extraClass:"field__status"},o.a.createElement(T,{status:r})))}a(954);var j=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(i)))).state={value:""},a.handleChange=function(e){a.setState({value:e.target.value})},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"search-bar component-coming-soon"},o.a.createElement(A.a,{id:"dropdown-refresh-rate"},o.a.createElement(A.a.Toggle,{bsStyle:"primary",id:"dropdown-basic"},"All"),o.a.createElement(A.a.Menu,null,["All","Some","Any"].map(function(e){return o.a.createElement(m.a,{active:"All"===e,key:"rate-index-item-".concat(e)},e)}))),o.a.createElement(d.a,{className:"small-icon",glyph:"search"}),o.a.createElement("input",{placeholder:"Search",value:this.state.value,onChange:this.handleChange}))}}]),t}(o.a.Component),K=(a(956),a(27)),L=a.n(K),q=a(40),z=a(17),$=a(165),ee=a.n($).a.create({baseURL:"http://10.1.49.185:9200"}),te="elastictest";function ae(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(q.a)(L.a.mark(function e(t){var a;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee.post("".concat(te,"/_search"),t).then(function(e){return e.data.hits.hits});case 2:return a=e.sent,e.abrupt("return",a.map(function(e){return Object(z.a)({},e._source,{id:e._id})}).map(function(e){return{id:e.id,date:e.EventDatetime,policy:e.PolicyID,source:e.SourceID,service:{protocol:"",port:e.DestinationPort,tcp:"UDP",status:""},application:"",destination:e.DestinationID,actions:[e.EventAction],alert:"Threat",status:"active"}}));case 4:case"end":return e.stop()}},e,this)}))).apply(this,arguments)}var re=a(56),ce=a(194);function le(){return{type:ce.b}}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:ce.c,payload:{results:e,append:t}}}function se(e){return{type:ce.a,payload:{message:e}}}var oe="50";var Ae=[{value:0,text:"Freeze"},{value:5,text:"30 seconds"},{value:60,text:"Every minute"}],me=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(c.a)(this,Object(l.a)(t).call(this,e))).startSyncingInterval=function(){var e=a.state.rate.value;if(a.state.interval&&clearInterval(a.state.interval),0!==e){var t=setInterval(function(){a.props.fetchNewest()},1e3*e);a.setState({interval:t})}},a.handleChangeRefreshRate=function(e){a.setState({rate:e},function(){a.startSyncingInterval()})},a.changeFilter=function(e){a.setState({filter:e})},a.handleRefresh=function(){a.props.fetchReports()},a.renderRefreshRateDropdown=function(){return o.a.createElement("div",{className:"reports__filters-refresh"},o.a.createElement("p",null,"Refresh: "),o.a.createElement(A.a,{id:"dropdown-refresh-rate"},o.a.createElement(A.a.Toggle,{id:"dropdown-basic"},a.state.rate.text),o.a.createElement(A.a.Menu,null,Ae.map(function(e){return o.a.createElement(m.a,{active:e.value===a.state.rate.value,key:"rate-index-item-".concat(e.value),onSelect:function(){return a.handleChangeRefreshRate(e)}},e.text)}))))},a.renderFilterButtons=function(){var e=a.state.filter;return o.a.createElement(u.a,{className:"reports__filters-buttons"},o.a.createElement(p.a,{onClick:function(){return a.changeFilter(0)},bsStyle:0===e?"primary":"default"},"All"),o.a.createElement(p.a,{onClick:function(){return a.changeFilter(1)},bsStyle:1===e?"primary":"default"},"Allowed"),o.a.createElement(p.a,{onClick:function(){return a.changeFilter(2)},bsStyle:2===e?"primary":"default"},"Alert"))},a.renderReports=function(e){return a.props.items.map(function(t){return o.a.createElement(X,{key:"reports-table-item-".concat(t.id,"-").concat(t.date),responsive:e,data:t})})},a.state={rate:{value:0,text:"Freeze"},filter:0,interval:null},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchReports(),this.startSyncingInterval()}},{key:"componentWillUnmount",value:function(){clearInterval(this.state.interval)}},{key:"render",value:function(){return o.a.createElement("div",{className:"content reports"},o.a.createElement("div",{className:"reports__search-bar"},o.a.createElement(j,null)),o.a.createElement("div",{className:"reports__filters"},o.a.createElement("div",{className:"left-container"},o.a.createElement("p",null,"Realtime View")),o.a.createElement("div",{className:"right-container"},this.renderRefreshRateDropdown(),o.a.createElement(d.a,{className:"small-icon refresh-button",glyph:"repeat",onClick:this.handleRefresh}),this.renderFilterButtons())),o.a.createElement(g.a.Container,{root:"reports"},o.a.createElement(g.a.Content,{root:"reports",headerComponent:o.a.createElement(g.a.Header,{items:v.C}),renderItems:this.renderReports})),0!==this.props.items.length&&!this.props.isLoading&&o.a.createElement("p",{onClick:this.props.fetchOlder,className:"reports__more-button"},"Load older reports"),this.props.isLoading&&o.a.createElement("div",{className:"loader-container"},o.a.createElement(f.a,null)))}}]),t}(s.Component);me.defaultProps={items:[]};var ue=Object(h.b)(["FETCHING_REPORTS"]),pe=Object(h.a)(["FETCHING_REPORTS"]);t.default=Object(E.b)(function(e){return{items:e.reports.items,isLoading:ue(e),error:pe(e)}},function(e){return{fetchReports:function(){return e(function(){var e=Object(q.a)(L.a.mark(function e(t,a){var n;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(le()),e.next=4,re.i({ecosystem:a().ecosystems.currentecosystem.uuid,customer:a().auth.selectedCustomer.id,query:{query:{bool:{must:{match_all:{}}}},sort:{EventDatetime:{order:"asc"}},size:oe}});case 4:n=e.sent,t(ie(n)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),t(se(e.t0));case 11:case"end":return e.stop()}},e,this,[[0,8]])}));return function(t,a){return e.apply(this,arguments)}}())},fetchNewest:function(){return e(function(){var e=Object(q.a)(L.a.mark(function e(t,a){var n,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a().reports.items[0],e.prev=1,t(le()),e.next=5,ae({query:{bool:{must:{match_all:{}},filter:{range:{EventDatetime:{gt:n.date}}}}},sort:{EventDatetime:{order:"desc"}},size:oe});case 5:r=e.sent,t(ie(r,!0)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(se());case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,a){return e.apply(this,arguments)}}())},fetchOlder:function(){return e(function(){var e=Object(q.a)(L.a.mark(function e(t,a){var n,r;return L.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a().reports.items[a().reports.items.length-1],e.prev=1,t(le()),e.next=5,ae({query:{bool:{must:{match_all:{}},filter:{range:{EventDatetime:{lt:n.date}}}}},sort:{EventDatetime:{order:"desc"}},size:oe});case 5:r=e.sent,t(ie(r,!0)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),t(se());case 12:case"end":return e.stop()}},e,this,[[1,9]])}));return function(t,a){return e.apply(this,arguments)}}())}}})(me)}}]);
//# sourceMappingURL=2.8c75a463.chunk.js.map